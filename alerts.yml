groups:
- name: container_alerts
  rules:
  - alert: HighContainerMemoryUsage
    expr: container_memory_usage_bytes{name!=""} > 30 * 1024 * 1024 * 1024
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "High memory usage detected for container {{ $labels.container_name }}"
      description: "Container {{ $labels.container_name }} is using more than 30GB of RAM. Current usage: {{ $value }} bytes."

  - alert: HighServerMemoryUsage
    expr: (node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) > 25 * 1024 * 1024 * 1024
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "High memory usage detected"
      description: "The server is using more than 25GB of RAM. Current usage: {{ $value }} bytes."

  - alert: HighCPUUsage
    expr: (1 - avg by(instance)(rate(node_cpu_seconds_total{mode="idle"}[1m]))) > 0.8
    for: 1m
    labels:
      severity: critical
    annotations:
      summary: "High CPU usage detected"
      description: "The server is using more than 80% of CPU. Current usage: {{ $value }}."

